<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carimbo Adjacencia</title>
    <link rel="icon" type="image/png" href="icons/nt.png">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #9370DB;
            
        }
        .container {
            border: 2px solid #000;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            background-color: #f9f9f9;
            margin-bottom: 30px;
        }
        .titulo {
            background-color: #9370DB; /* Roxo mais claro */
            color: #fff; /* Branco */
            padding: 10px;
            text-align: center;
            font-size: 1.5em;
            margin-bottom: 20px;
        }
        .carimbo {
            border: 2px solid #000;
            margin-top: 20px;
            display: none;
        }
        .carimboTitulo {
            background-color: #9370DB; /* Roxo mais claro */
            color: #fff; /* Branco */
            padding: 10px;
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 9px;
        }
        table, th, td {
            border: 3px solid #d3d3d3; /* Linhas cinza claro e mais grossas */
        }
        th, td {
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #9370DB; /* Roxo mais claro */
            color: #fff; /* Branco */
        }
        td {
            background-color: #fff; /* Branco */
        }
        textarea {
            width: 100%;
            height: 100px;
        }
        .botoes {
            margin-top: 20px;
        }
        .botoes button {
            margin-right: 10px;
        }
        #atencao {
            display: none;
        }
        .atencaoLaranja {
            color: #FF8C00; /* Laranja escuro */
        }
        .tabela-container {
            height: auto;
            width: 100vw;
            max-width: 100%;
            overflow-x: auto;
            border: 1px solid #d3d3d3;
            background: white;
            padding: 5px;
            font-size: 10px;
            font-weight: bold;
            margin: 1px 0; /* Adiciona espa√ßamento entre as tabelas */
        }

        .tabela-container th {
        text-align: center; 
        vertical-align: middle; 
        }

        #mensagem-selecao {
    position: relative;
    margin-bottom: 20px; /* Espa√ßo entre o texto e as tabelas */
    text-align: center;
    font-size: 20px;
    font-family: Arial, sans-serif;
    font-weight: bold;
    animation: piscar 0.7s infinite alternate;
}

        @keyframes piscar {
            0% { color: #ff0000; }
        }

        

        .botoes-button2 {
    background-color: #9370DB;
    color: #fff;
    border: none;
    padding: 6px 40px;
    cursor: pointer;
    border-radius: 4px;
    font-size: 16px;
    margin-bottom: 1px;
    margin-top: 1px;
    vertical-align: middle;
}

/* Cont√™iner para centralizar o bot√£o horizontalmente */
.button-container {
    display: flex;
    justify-content: center;  /* Alinha o bot√£o no centro horizontal */
    margin-top: 20px;         /* Mant√©m a posi√ß√£o vertical que voc√™ j√° queria */
    margin-bottom: 15px;
}


#conteudo {
    display: flex;
    flex-direction: column; /* Alinha os itens de forma vertical */
    justify-content: center; /* Centraliza no eixo vertical */
    align-items: center; /* Centraliza no eixo horizontal */
    height: auto; /* Ocupa 100% da altura da tela */
    margin: 0; /* Remove qualquer margem */
    padding: 0; /* Remove qualquer padding */
    text-align: center; /* Alinha o conte√∫do das tabelas ao centro */
}

/* Estilo da tabela-container */

/* Outras regras para estiliza√ß√£o das tabelas */
table {
    width: 100%;
    border-collapse: collapse;
}

table, th, td {
    border: 3px solid #d3d3d3; /* Linhas cinza claro e mais grossas */
}

th, td {
    padding: 8px;
    text-align: left;
}

th {
    background-color: #9370DB; /* Roxo mais claro */
    color: #fff; /* Branco */
}

td {
    background-color: #fff; /* Branco */
}

textarea {
    width: 100%;
    height: 100px;
}

.botoes {
    margin-top: 10px;
}

.botoes button {
    margin-right: 10px;
}

#atencao {
    display: none;
}

.atencaoLaranja {
    color: #FF8C00; /* Laranja escuro */
}

/* Estilo do bot√£o para centraliza√ß√£o */
.button-container {
    display: flex;
    justify-content: center;  /* Alinha o bot√£o no centro horizontal */
    margin-top: 3px;         /* Mant√©m a posi√ß√£o vertical que voc√™ j√° queria */
    margin-bottom: 3px;
}

.tabela-container {
            display: none; /* Oculta todas as tabelas inicialmente */
        }
        .container-principal {
        background-color: #fff; /* Fundo branco */
        border-radius: 15px; /* Bordas arredondadas */
        padding: 20px; /* Espa√ßamento interno */
        margin: 20px auto; /* Centraliza o container */
        width: 90%; /* Largura responsiva */
        max-width: 1200px; /* Limita a largura m√°xima */
        box-shadow: 0 4px 8px rgba(0, 0, 0, 1); /* Sombra suave */
        }


    </style>
</head>
<body>
    <div class="container-principal">
    <!-- Cont√™iner para centralizar todo o conte√∫do -->
<div id="conteudo">
    <!-- Mensagem de sele√ß√£o -->
    <div id="mensagem-selecao" style="display: none;">Selecione o tipo de adjac√™ncia!</div>

    <!-- Primeira Tabela -->
    <div class="tabela-container" id="tabela-OLT" style="display: none;">
        <table>
            <thead>
                <tr>
                    <th style="width: 90px;">CLUSTER</th>
                    <th style="width: 70px;">CIDADE</th>
                    <th style="width: 70px;">CNLAT</th>
                    <th style="width: 100px;">MINUTOS</th>
                    <th style="width: 100px;">CLIENTES</th>
                    <th style="width: 100px;">TQA_CODIGO</th>
                    <th style="width: 120px;">TRATATIVA</th>
                    <th style="width: 90px;">TIPO_FALHA</th>
                    <th style="width: 90px;">DATA_CRIA√á√ÉO</th>
                    <th style="width: 130px;">OLT</th>
                    <th style="width: 120px;">EQUIP</th>
                    <th style="width: 120px;">MASSIVA</th>
                    <th style="width: 90px;">SEVERIDADE</th>
                </tr>
            </thead>
            <tbody class="tabela-body"></tbody>
        </table>
    </div>

    <!-- Segunda Tabela -->
    <div class="tabela-container" id="tabela-HL4" style="display: none;">
        <table>
            <thead>
                <tr>
                    <th style="width: 90px;">CLUSTER</th>
                    <th style="width: 70px;">CIDADE</th>
                    <th style="width: 70px;">MINUTOS</th>
                    <th style="width: 100px;">CLIENTES</th>
                    <th style="width: 100px;">TQA_CODIGO</th>
                    <th style="width: 100px;">TQA_RAIZ</th>
                    <th style="width: 90px;">TIPO_FALHA</th>
                    <th style="width: 70px;">DATA_CRIA√á√ÉO</th>
                    <th style="width: 70px;">HOSTNAME</th>
                    <th style="width: 100px;">EQUIP</th>
                    <th style="width: 100px;">SEVERIDADE</th>
                </tr>
            </thead>
            <tbody class="tabela-body"></tbody>
        </table>
    </div>

    <!-- Terceira Tabela -->
    <div class="tabela-container" id="tabela-SWD" style="display: none;">
        <table>
            <thead>
                <tr>
                    <th style="width: 90px;">CONTRATO</th>
                    <th style="width: 70px;">MUNICIPIO</th>
                    <th style="width: 70px;">TQA_CODIGO</th>
                    <th style="width: 100px;">TQA_RAIZ</th>
                    <th style="width: 100px;">TIPO_BILHETE</th>
                    <th style="width: 100px;">DATA_CRIA√á√ÉO</th>
                    <th style="width: 90px;">HOSTNAME</th>
                    <th style="width: 70px;">NOME_REDE_AGREGADOR</th>
                </tr>
            </thead>
            <tbody class="tabela-body"></tbody>
        </table>
    </div>


    <div class="tabela-container" id="tabela-CONDOM√çNIO" style="display: none;">
        <table>
            <thead>
                <tr>
                    <th style="width: 90px;">REGIONAL</th>
                    <th style="width: 70px;">MINUTOS</th>
                    <th style="width: 70px;">CONDOM√çNIO</th>
                    <th style="width: 70px;">TA</th>
                    <th style="width: 100px;">FALHA</th>
                    <th style="width: 100px;">DATA CRIA√á√ÉO</th>
                    <th style="width: 100px;">TIPO FALHA</th>
                </tr>
            </thead>
            <tbody class="tabela-body"></tbody>
        </table>
    </div>

    <!-- Bot√£o de a√ß√£o -->
    <div class="button-container">
        <button class="limparTabela botoes-button2">Limpar</button>
    </div>
</div>

    <div class="container">
        <div class="titulo">NT - SPI üöß Perda de ADJ (OLT,SWD,HL4) üöß</div>
        <h1>Formul√°rio</h1>
        <form id="meuFormulario">
            <label for="tipo">Tipo:</label>
            <select id="tipo" name="tipo" required>
                <option value="" hidden>SELECIONE</option>
                <option value="CONDOM√çNIO">CONDOM√çNIO</option>
                <option value="OLT">OLT</option>
                <option value="SWD">SWD</option>
                <option value="HL4">HL4</option>
            </select><br><br>
            <label for="ta">TA:</label>
            <input type="text" id="ta" name="ta" required><br><br>
            <label for="municipio">Municipio:</label>
            <input type="text" id="municipio" name="municipio" required><br><br>
            <label for="hostname">Hostname:</label>
            <input type="text" id="hostname" name="hostname" required><br><br>
            <label for="dataFalha">Data da Falha:</label>
            <input type="datetime-local" id="dataFalha" name="dataFalha" required><br><br>
            <label for="status">Status:</label>
            <textarea id="status" name="status" required></textarea><br><br>
            <label for="atencao" id="atencaoLabel">Aten√ß√£o:</label>
            <input type="text" id="atencao" name="atencao" readonly class="atencaoLaranja"><br><br>
            <button type="submit">Enviar</button>
        </form>
        <div class="carimbo" id="carimbo">
            <div class="carimboTitulo">NT-SPI üöß Perda de ADJ (OLT,SWD,HL4)üöß</div>
            <table>
                <tr>
                    <th>Descri√ß√£o</th>
                    <th>Atualiza√ß√£o</th>
                </tr>
                <tr>
                    <td>Tipo</td>
                    <td><span id="carimboTipo"></span></td>
                </tr>
                <tr>
                    <td>TA</td>
                    <td><span id="carimboTA"></span></td>
                </tr>
                <tr>
                    <td>Municipio</td>
                    <td><span id="carimboMunicipio"></span></td>
                </tr>
                <tr>
                    <td>Hostname</td>
                    <td><span id="carimboHostname"></span></td>
                </tr>
                <tr>
                    <td>Data da Falha</td>
                    <td><span id="carimboDataFalha"></span></td>
                </tr>
                <tr>
                    <td>Status</td>
                    <td><span id="carimboStatus"></span></td>
                </tr>
                <tr>
                    <td>Aten√ß√£o</td>
                    <td><span id="carimboAtencao" class="atencaoLaranja"></span></td>
                </tr>
            </table>
            <div class="botoes">
                <button id="voltar">Voltar</button>
            </div>
        </div>
    </div>
</div>
    <script>



document.addEventListener("DOMContentLoaded", function () {
    const tipoSelect = document.getElementById("tipo");
    const carimboAtencao = document.getElementById("carimboAtencao");
    const carimboAtencaoRow = carimboAtencao.closest("tr"); // Pega a linha do "Aten√ß√£o"

    function verificarTipo() {
        const tipoSelecionado = tipoSelect.value;

        // Se o tipo for OLT, exibe a linha de Aten√ß√£o
        if (tipoSelecionado === "OLT") {
            carimboAtencaoRow.style.display = "table-row"; // Exibe a linha
        } else {
            carimboAtencaoRow.style.display = "none"; // Oculta a linha
        }
    }

    // Chama a fun√ß√£o ao mudar o tipo
    tipoSelect.addEventListener("change", verificarTipo);

    // Inicializa a visibilidade ao carregar
    verificarTipo();
});






document.addEventListener("DOMContentLoaded", function () {
    const tipoSelect = document.getElementById("tipo");
    const taInput = document.getElementById("ta");
    const municipioInput = document.getElementById("municipio");
    const hostnameInput = document.getElementById("hostname");
    const dataFalhaInput = document.getElementById("dataFalha"); // Atualizado para "Data da Falha"

    function atualizarCampos() {
        const tipoSelecionado = tipoSelect.value;
        let tabelaSelecionada;
        let taValor = "";
        let municipioValor = "";
        let hostnameValor = "";
        let dataFalhaValor = "";

        // Identifica a tabela vis√≠vel
        if (tipoSelecionado === "OLT") {
            tabelaSelecionada = document.querySelector("#tabela-OLT tbody");
        } else if (tipoSelecionado === "HL4") {
            tabelaSelecionada = document.querySelector("#tabela-HL4 tbody");
        } else if (tipoSelecionado === "SWD") {
            tabelaSelecionada = document.querySelector("#tabela-SWD tbody");
        } else if (tipoSelecionado === "CONDOM√çNIO") {
            tabelaSelecionada = document.querySelector("#tabela-CONDOM√çNIO tbody");
        }

        if (!tabelaSelecionada) return;

        // Captura a primeira linha da tabela (se houver dados)
        const primeiraLinha = tabelaSelecionada.querySelector("tr");
        if (primeiraLinha) {
            const colunas = primeiraLinha.getElementsByTagName("td");

            // Define as colunas corretas para TA, Munic√≠pio, Hostname e Data da Falha
            if (tipoSelecionado === "HL4") {
                taValor = colunas[4]?.textContent.trim(); // 5¬™ coluna (√≠ndice 4)
                municipioValor = colunas[1]?.textContent.trim(); // 2¬™ coluna (√≠ndice 1)
                hostnameValor = colunas[8]?.textContent.trim(); // 9¬™ coluna (√≠ndice 8)
                dataFalhaValor = colunas[7]?.textContent.trim(); // 8¬™ coluna (√≠ndice 7)
            } else if (tipoSelecionado === "OLT") {
                taValor = colunas[5]?.textContent.trim(); // 6¬™ coluna (√≠ndice 5)
                municipioValor = colunas[1]?.textContent.trim(); // 3¬™ coluna (√≠ndice 2)
                hostnameValor = colunas[9]?.textContent.trim(); // 10¬™ coluna (√≠ndice 9)
                dataFalhaValor = colunas[8]?.textContent.trim(); // 9¬™ coluna (√≠ndice 8)
            } else if (tipoSelecionado === "SWD") {
                taValor = colunas[2]?.textContent.trim(); // 3¬™ coluna (√≠ndice 2)
                municipioValor = colunas[1]?.textContent.trim(); // 2¬™ coluna (√≠ndice 1)
                hostnameValor = colunas[6]?.textContent.trim(); // 9¬™ coluna (√≠ndice 8)
                dataFalhaValor = colunas[5]?.textContent.trim(); // 3¬™ coluna (√≠ndice 2)
            } else if (tipoSelecionado === "CONDOM√çNIO") {
                taValor = colunas[3]?.textContent.trim(); // 3¬™ coluna (√≠ndice 2)
                municipioValor = colunas[2]?.textContent.trim(); // 2¬™ coluna (√≠ndice 1)
                hostnameValor = colunas[6]?.textContent.trim(); // 9¬™ coluna (√≠ndice 8)
                dataFalhaValor = colunas[5]?.textContent.trim(); // 3¬™ coluna (√≠ndice 2)
            }

            // Preenche os campos com os valores encontrados
            taInput.value = taValor || "";
            municipioInput.value = municipioValor || "";
            hostnameInput.value = hostnameValor || "";
            dataFalhaInput.value = dataFalhaValor || "";
        }
    }

    // Monitora mudan√ßas no select para atualizar os campos ao trocar de tabela
    tipoSelect.addEventListener("change", atualizarCampos);

    // Observa mudan√ßas no conte√∫do da tabela e atualiza os campos automaticamente
    const observer = new MutationObserver(atualizarCampos);

    observer.observe(document.querySelector("#tabela-OLT tbody"), { childList: true, subtree: true });
    observer.observe(document.querySelector("#tabela-HL4 tbody"), { childList: true, subtree: true });
    observer.observe(document.querySelector("#tabela-SWD tbody"), { childList: true, subtree: true });
    observer.observe(document.querySelector("#tabela-CONDOM√çNIO tbody"), { childList: true, subtree: true });
});





        

document.addEventListener("DOMContentLoaded", function () {
    const tipoSelect = document.getElementById("tipo");
    const atencaoInput = document.getElementById("atencao");
    const atencaoLabel = document.getElementById("atencaoLabel");

    const listaEquipamentos = [
        'BR_CASAL_OLT02', 'BR_FZBBFL_OLT01', 'BR_CASSS_OLT04', 'BR_SOCED_OLT01', 'BR_ITVCX_OLT05',
        'BR_ITURT_OLT03', 'BR_BGPAV_OLT01', 'BR_LMEBO_OLT01', 'BR_JAIVI_OLT06', 'BR_ARDDR_OLT02',
        'BR_SREPC_OLT01', 'BR_SPBCB_OLT01', 'BR_BGPSC_OLT05', 'BR_ITAMD_OLT01', 'BR_PRFBO_OLT01',
        'BR_PRFPF_OLT04', 'BR_AIAMR_OLT01', 'BR_UTBLZ_OLT01', 'BR_UTBPG_OLT01', 'BR_UTBMA_OLT01',
        'BR_JQBJQ_OLT02', 'BR_ITACS_OLT03', 'BR_PIARG_OLT01', 'BR_ITUPI_OLT01', 'BR_JAICB_OLT02',
        'BR_MRESPB_OLT01', 'BR_ITUCC_OLT01', 'BR_ITURT_OLT04', 'BR_MRESPJ_OLT01', 'BR_TTEAM_OLT09',
        'BR_BOPUBP_OLT04'
    ];

    function verificarHostname() {
        const tipoSelecionado = tipoSelect.value;
        let tabelaOLT = document.querySelector("#tabela-OLT tbody");
        let hostnameValor = "";

        if (tipoSelecionado === "OLT" && tabelaOLT) {
            const primeiraLinha = tabelaOLT.querySelector("tr");
            if (primeiraLinha) {
                const colunas = primeiraLinha.getElementsByTagName("td");
                hostnameValor = colunas[9]?.textContent.trim(); // Coluna 10 (√≠ndice 9)
            }
        }

        if (tipoSelecionado === "OLT") {
            if (listaEquipamentos.includes(hostnameValor)) {
                atencaoInput.value = "!!OLT FLAT!!";
            } else {
                atencaoInput.value = "";
            }
            atencaoInput.style.display = "block";
            atencaoLabel.style.display = "block";
        } else {
            atencaoInput.style.display = "none";
            atencaoLabel.style.display = "none";
        }
    }

    // Chama a fun√ß√£o ao mudar o tipo
    tipoSelect.addEventListener("change", verificarHostname);

    // Observa mudan√ßas na tabela OLT para atualizar automaticamente
    const observer = new MutationObserver(verificarHostname);
    observer.observe(document.querySelector("#tabela-OLT tbody"), { childList: true, subtree: true });
});


        document.getElementById('meuFormulario').addEventListener('submit', function(event) {
            event.preventDefault();
            var tipo = document.getElementById('tipo').value;
            var ta = document.getElementById('ta').value;
            var municipio = document.getElementById('municipio').value;
            var hostname = document.getElementById('hostname').value;
            var dataFalha = document.getElementById('dataFalha').value;
            var status = document.getElementById('status').value;
            var atencao = document.getElementById('atencao').value;

            function formatarDataHora(dataHora) {
                if (!dataHora) return '';
                var data = new Date(dataHora);
                var dia = String(data.getDate()).padStart(2, '0');
                var mes = String(data.getMonth() + 1).padStart(2, '0');
                var ano = data.getFullYear();
                var horas = String(data.getHours()).padStart(2, '0');
                var minutos = String(data.getMinutes()).padStart(2, '0');
                return `${dia}/${mes}/${ano} ${horas}:${minutos}`;
            }

            document.getElementById('carimboTipo').textContent = tipo;
            document.getElementById('carimboTA').textContent = ta;
            document.getElementById('carimboMunicipio').textContent = municipio;
            document.getElementById('carimboHostname').textContent = hostname;
            document.getElementById('carimboDataFalha').textContent = formatarDataHora(dataFalha);
            document.getElementById('carimboStatus').textContent = status;
            document.getElementById('carimboAtencao').textContent = atencao;
            document.getElementById('carimbo').style.display = 'block';
        });

       





        document.getElementById('voltar').addEventListener('click', function() {
    // Oculta o carimbo e reseta o formul√°rio
    document.getElementById('carimbo').style.display = 'none';
});

// Fun√ß√£o para limpar os campos do formul√°rio, limpar os valores da tabela e esconder o carimbo
function limparTabela() {
    let tipoSelecionado = document.getElementById("tipo").value;

    // Limpa os campos de entrada
    const inputs = document.querySelectorAll('#meuFormulario input, #meuFormulario select, #meuFormulario textarea');
    inputs.forEach(input => {
        input.value = ''; // Limpa o valor do campo de entrada
    });

    // Limpa os valores exibidos nos spans da tabela (os valores do carimbo)
    document.getElementById('carimboTipo').textContent = '';
    document.getElementById('carimboTA').textContent = '';
    document.getElementById('carimboMunicipio').textContent = '';
    document.getElementById('carimboHostname').textContent = '';
    document.getElementById('carimboDataFalha').textContent = '';
    document.getElementById('carimboStatus').textContent = '';

    // Oculta o carimbo
    document.getElementById('carimbo').style.display = 'none';

    // Resetar o valor do "Tipo" para a op√ß√£o "SELECIONE"
    document.getElementById("tipo").value = "";

    // Assegura que a op√ß√£o "SELECIONE" seja selecionada
    const selectTipo = document.getElementById("tipo");
    const optionDefault = selectTipo.querySelector('option[value=""]');
    if (optionDefault) {
        optionDefault.selected = true;
    }

    // Ocultar todas as tabelas, j√° que o select foi resetado
    ocultarTabelas();

    // Ocultar o bot√£o de limpar e mostrar a mensagem de sele√ß√£o
    ocultarBotaoLimpar();
    mostrarMensagem();
}

// Adiciona o evento de click ao bot√£o "Limpar"
document.querySelector(".limparTabela").addEventListener("click", limparTabela);









        


        // Fun√ß√£o para ocultar todas as tabelas
function ocultarTabelas() {
    document.querySelectorAll(".tabela-container").forEach(tabela => tabela.style.display = "none");
}

// Fun√ß√£o para ocultar o bot√£o de limpar
function ocultarBotaoLimpar() {
    let botaoLimpar = document.querySelector(".limparTabela");
    botaoLimpar.style.display = "none"; // Esconde o bot√£o de limpar
}

// Fun√ß√£o para mostrar o bot√£o de limpar
function mostrarBotaoLimpar() {
    let botaoLimpar = document.querySelector(".limparTabela");
    botaoLimpar.style.display = "block"; // Exibe o bot√£o de limpar
}

// Fun√ß√£o para exibir a mensagem "Selecione o tipo de adjac√™ncia"
function mostrarMensagem() {
    let mensagem = document.getElementById("mensagem-selecao");
    mensagem.style.display = "block"; // Exibe a mensagem
}

// Fun√ß√£o para ocultar a mensagem "Selecione o tipo de adjac√™ncia"
function esconderMensagem() {
    let mensagem = document.getElementById("mensagem-selecao");
    mensagem.style.display = "none"; // Esconde a mensagem
}

// Ocultar as tabelas, o bot√£o de limpar e a mensagem ao carregar a p√°gina
window.onload = function() {
    ocultarTabelas();  // Garantir que as tabelas est√£o ocultas no carregamento
    ocultarBotaoLimpar();  // Esconde o bot√£o de limpar ao carregar a p√°gina
    mostrarMensagem();  // Exibe a mensagem ao carregar
}

// Adicionando o evento de mudan√ßa ao select
document.getElementById("tipo").addEventListener("change", function() {
    let tipoSelecionado = this.value;

    // Ocultar todas as tabelas
    ocultarTabelas();

    // Ocultar o bot√£o de limpar se nenhuma tabela estiver selecionada
    if (tipoSelecionado === "") {
        ocultarBotaoLimpar();
        mostrarMensagem(); // Exibe a mensagem quando nenhum tipo for selecionado
    } else {
        // Mostrar a tabela correspondente se o valor for diferente de vazio
        let tabelaSelecionada = document.getElementById(`tabela-${tipoSelecionado}`);
        if (tabelaSelecionada) tabelaSelecionada.style.display = "block";

        // Mostrar o bot√£o de limpar
        mostrarBotaoLimpar();
        esconderMensagem(); // Esconde a mensagem quando uma tabela for selecionada
    }
});

    const colunasPorTabela = {
    "OLT": 13,
    "HL4": 10,
    "SWD": 8,
    "CONDOM√çNIO": 7
};

function criarLinha(tipo, valores = []) {
    // Seleciona o corpo da tabela pelo tipo
    let tabela = document.getElementById(`tabela-${tipo}`).querySelector("tbody");
    let novaLinha = tabela.insertRow();
    let totalCelulas = colunasPorTabela[tipo] || 0;

    // Cria c√©lulas conforme o n√∫mero de colunas
    for (let i = 0; i < totalCelulas; i++) {
        let celula = novaLinha.insertCell();
        celula.contentEditable = "true"; // Torna a c√©lula edit√°vel
        celula.textContent = valores[i] || ""; // Preenche com o valor ou vazio
    }
}

function inicializarTabela(tipo, linhas = 1) {
    // Seleciona o corpo da tabela
    let tabela = document.getElementById(`tabela-${tipo}`).querySelector("tbody");
    tabela.innerHTML = ""; // Limpa a tabela
    for (let i = 0; i < linhas; i++) {
        criarLinha(tipo); // Cria as linhas da tabela
    }
}

document.querySelector(".limparTabela").addEventListener("click", limparTabela);

document.getElementById("tipo").addEventListener("change", function() {
    let tipoSelecionado = this.value;
    let tabelas = document.querySelectorAll(".tabela-container");
    
    tabelas.forEach(tabela => tabela.style.display = "none");
    
    let tabelaSelecionada = document.getElementById(`tabela-${tipoSelecionado}`);
    if (tabelaSelecionada) {
        tabelaSelecionada.style.display = "block"; // Exibe a tabela selecionada
        inicializarTabela(tipoSelecionado); // Inicializa a tabela
    }
});

// Inicializa a tabela OLT ao carregar a p√°gina
document.getElementById("tabela-OLT").style.display = "block";
inicializarTabela("OLT");

// Fun√ß√£o de paste
document.addEventListener("paste", function(event) {
    let target = event.target;
    if (target.tagName.toLowerCase() === 'td') {
        event.preventDefault(); // Evita a a√ß√£o padr√£o de colagem
        let pasteData = event.clipboardData.getData("text");
        let linhas = pasteData.split("\n").filter(linha => linha.trim() !== ""); // Quebra os dados por linha
        linhas.forEach((linha, linhaIndex) => {
            let colunas = linha.split("\t"); // Quebra os dados por tabula√ß√£o (colunas)
            colunas.forEach((valor, colunaIndex) => {
                let linhaTabela = target.parentNode.parentNode.rows[linhaIndex];
                if (linhaTabela) {
                    let celula = linhaTabela.cells[colunaIndex];
                    if (celula) {
                        celula.innerText = valor; // Define o valor na c√©lula
                    }
                }
            });
        });
    }
});

// Inicializa a tabela ao carregar a p√°gina
inicializarTabela("OLT");

// Ajustando o evento para exibir a tabela de acordo com o tipo selecionado
document.getElementById("tipo").addEventListener("change", function() {
    let tipoSelecionado = this.value;
    let tabelas = document.querySelectorAll(".tabela-container-1");
    
    tabelas.forEach(tabela => tabela.style.display = "none");

    if (tipoSelecionado !== "") {
        let tabelaSelecionada = document.getElementById(`tabela-${tipoSelecionado}`);
        if (tabelaSelecionada) {
            tabelaSelecionada.style.display = "block";
            inicializarTabela(tipoSelecionado); // Inicializa a tabela do tipo selecionado
        }
    }
});
    </script>
</body>
</html>

<div class="sair">
    <img src="icons/HP.png" alt="√çcone de Porta" class="icone-porta">
    <span>Sair</span>
</div>

<style>
    .sair {
        position: fixed;
        top: 10px;
        left: 10px;
        display: flex;
        align-items: center;
        cursor: pointer;
        z-index: 9999; /* Fica sempre no topo */
        background-color: rgba(255, 255, 255, 0.8); /* Fundo branco com leve transpar√™ncia */
        padding: 5px;
        border-radius: 8px;
    }

    .icone-porta {
        width: 30px;
        height: 30px;
        margin-right: 5px;
    }

    .sair span {
        font-size: 18px;
        font-weight: bold;
    }

    .sair:hover {
        opacity: 0.8;
    }
</style>

<script>
    document.querySelector('.sair').addEventListener('click', function() {
        window.location.href = "HOME.html"; // Substitua com o caminho da sua p√°gina
    });
</script>
